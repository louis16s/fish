<?xml version="1.0" encoding="UTF-8"?>
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="1600"
  height="900"
  viewBox="0 0 1600 900"
  role="img"
  aria-label="外塘/内塘水位与水闸示意图">
  <title>水位与水闸示意</title>
  <desc>左侧外塘、右侧内塘，中间水闸。水体为独立对象：water_left/water_right/channel_water。闸门为可滑动闸板：gate_plate_group（由页面脚本设置开度）。</desc>

  <defs>
    <!-- Water gradients -->
    <!-- Outer pond (left): blue -->
    <linearGradient id="gradWaterOuter" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#60a5fa" stop-opacity="0.95" />
      <stop offset="0.55" stop-color="#2563eb" stop-opacity="0.92" />
      <stop offset="1" stop-color="#1e3a8a" stop-opacity="0.95" />
    </linearGradient>
    <!-- Inner pond (right): cyan/teal -->
    <linearGradient id="gradWaterInner" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#67e8f9" stop-opacity="0.95" />
      <stop offset="0.55" stop-color="#06b6d4" stop-opacity="0.92" />
      <stop offset="1" stop-color="#0e7490" stop-opacity="0.95" />
    </linearGradient>
    <!-- Channel: default mix (can be overridden by data-src) -->
    <linearGradient id="gradWaterChannel" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#7dd3fc" stop-opacity="0.95" />
      <stop offset="0.55" stop-color="#38bdf8" stop-opacity="0.92" />
      <stop offset="1" stop-color="#1d4ed8" stop-opacity="0.95" />
    </linearGradient>
    <linearGradient id="gradWaterOffline" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#fb7185" stop-opacity="0.92" />
      <stop offset="1" stop-color="#be123c" stop-opacity="0.90" />
    </linearGradient>
    <linearGradient id="gradSteel" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#cbd5e1"/>
      <stop offset="0.45" stop-color="#94a3b8"/>
      <stop offset="1" stop-color="#64748b"/>
    </linearGradient>
    <linearGradient id="gradWall" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#0f172a" stop-opacity="0.92"/>
      <stop offset="1" stop-color="#0b1224" stop-opacity="0.98"/>
    </linearGradient>

    <!-- Soft shadow for inner parts -->
    <filter id="shadowSoft" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="#0b1224" flood-opacity="0.18"/>
    </filter>

    <!-- Clip: inside gate frame (so channel water & FX don't bleed into the stroke) -->
    <clipPath id="clip_gate_inner">
      <rect x="752" y="192" width="96" height="576" rx="12" />
    </clipPath>
  
    <style>
      /* Make 0–5m rulers clearer */
      #layer_scale text.scaleText{
        
        font-size: 32px;
paint-order: stroke fill;
        stroke: rgba(11,18,32,0.85);
        stroke-width: 3.4px;
      }
    </style>
</defs>

  <style>
    /* Keep SVG self-styled so the UI page can stay lightweight. */
    #water_left { fill: url(#gradWaterOuter); }
    #water_right { fill: url(#gradWaterInner); }
    #channel_water { fill: url(#gradWaterChannel); }
    /* Channel water can follow the source side: inner/outer. */
    #channel_water[data-src="outer"] { fill: url(#gradWaterOuter); }
    #channel_water[data-src="inner"] { fill: url(#gradWaterInner); }

    #water_left[data-valid="0"], #water_right[data-valid="0"] { fill: url(#gradWaterOffline); opacity: 0.85; }
    .water-surface { fill: rgba(255,255,255,0.38); mix-blend-mode: screen; }
    #grid line { stroke: rgba(148,163,184,0.20); stroke-width: 2; }
    #grid .major { stroke: rgba(148,163,184,0.28); }
    #flow_fx { opacity: 0.0; }
    #flow_fx[data-on="1"] { opacity: 1.0; }
    .flow-line { transform-box: fill-box; transform-origin: center; }
    @media (prefers-reduced-motion: no-preference) {
      #flow_fx[data-on="1"] #flow_dir_right .flow-line { animation: flowMoveR 1.1s linear infinite; }
      #flow_fx[data-on="1"] #flow_dir_left .flow-line { animation: flowMoveL 1.1s linear infinite; }
      #water_left_surface, #water_right_surface, #channel_water_surface {
        animation: surfaceBlink 2.2s ease-in-out infinite;
      }
    }
    @keyframes flowMoveR {
      from { transform: translateX(-70px); opacity: 0.35; }
      25% { opacity: 0.9; }
      75% { opacity: 0.9; }
      to { transform: translateX(70px); opacity: 0.35; }
    }
    @keyframes flowMoveL {
      from { transform: translateX(70px); opacity: 0.35; }
      25% { opacity: 0.9; }
      75% { opacity: 0.9; }
      to { transform: translateX(-70px); opacity: 0.35; }
    }
    @keyframes surfaceBlink {
      0%, 100% { opacity: 0.35; }
      50% { opacity: 0.60; }
    }
  </style>

  <!-- Layer: Background grid (subtle) -->
  <g id="grid" aria-hidden="true">
    <line x1="120" y1="200" x2="1480" y2="200" class="major"/>
    <line x1="120" y1="316" x2="1480" y2="316"/>
    <line x1="120" y1="432" x2="1480" y2="432"/>
    <line x1="120" y1="548" x2="1480" y2="548"/>
    <line x1="120" y1="664" x2="1480" y2="664"/>
    <line x1="120" y1="780" x2="1480" y2="780" class="major"/>
  </g>

  <!-- Layer: Water (editable, independent shapes for UI control) -->
  <g id="layer_water" filter="url(#shadowSoft)">
    <!-- Outer pond (left) water body. Full range: data-base-y + data-base-h -->
    <rect id="water_left"
      x="140" y="780"
      width="580" height="0"
      data-valid="1"
      data-base-y="200"
      data-base-h="580" />
    <rect id="water_left_surface" class="water-surface"
      x="140" y="780"
      width="580" height="8"
      style="display:none" />

    <!-- Inner pond (right) water body. Full range: data-base-y + data-base-h -->
    <rect id="water_right"
      x="880" y="780"
      width="580" height="0"
      data-valid="1"
      data-base-y="200"
      data-base-h="580" />
    <rect id="water_right_surface" class="water-surface"
      x="880" y="780"
      width="580" height="8"
      style="display:none" />

    <!-- Channel water inside gate (only meaningful when gate opens). Clipped to gate inner area. -->
    <rect id="channel_water"
      x="760" y="780"
      width="80" height="0"
      clip-path="url(#clip_gate_inner)"
      style="display:none"
      data-base-y="200"
      data-base-h="580" />
    <rect id="channel_water_surface" class="water-surface"
      x="760" y="780"
      width="80" height="8"
      clip-path="url(#clip_gate_inner)"
      style="display:none" />

    <!-- Flow FX (arrows/lines), toggled by UI. -->
    <g id="flow_fx" data-on="0" clip-path="url(#clip_gate_inner)" aria-hidden="true">
      <g id="flow_dir_right" style="display:none">
        <path class="flow-line" d="M768 740 H832" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="6" stroke-linecap="round" />
        <path class="flow-line" d="M820 728 L838 740 L820 752" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </g>
      <g id="flow_dir_left" style="display:none">
        <path class="flow-line" d="M832 740 H768" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="6" stroke-linecap="round" />
        <path class="flow-line" d="M780 728 L762 740 L780 752" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </g>
    </g>
  </g>

  <!-- Layer: Containers / Walls -->
  <g id="layer_containers" fill="none" stroke="rgba(226,232,240,0.92)" stroke-width="14" stroke-linecap="round" stroke-linejoin="round">
    <!-- Outer pond container (left) - open top, right side shares wall with gate frame -->
    <path id="pond_outer" d="M120 180 V780 H740" />

    <!-- Inner pond container (right) - open top, left side shares wall with gate frame -->
    <path id="pond_inner" d="M1480 180 V780 H860" />

    <!-- Gate frame (middle) -->
    <rect id="gate_frame" x="740" y="180" width="120" height="600" rx="14" />
  </g>

  <!-- Layer: Scale / Ruler (0-5m) -->
  <g id="layer_scale" stroke="#FF8A00" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"
     font-family="system-ui,-apple-system,'Segoe UI',Roboto,'PingFang SC','Microsoft YaHei',sans-serif"
     font-size="30" font-weight="900" fill="#FF8A00">
    <!-- Outer pond ruler (left) -->
    <line x1="120" y1="200" x2="120" y2="780" />
    <line x1="110" y1="200" x2="130" y2="200" /><text class="scaleText" x="102" y="206" text-anchor="end">5m</text>
    <line x1="110" y1="316" x2="130" y2="316" /><text class="scaleText" x="102" y="322" text-anchor="end">4m</text>
    <line x1="110" y1="432" x2="130" y2="432" /><text class="scaleText" x="102" y="438" text-anchor="end">3m</text>
    <line x1="110" y1="548" x2="130" y2="548" /><text class="scaleText" x="102" y="554" text-anchor="end">2m</text>
    <line x1="110" y1="664" x2="130" y2="664" /><text class="scaleText" x="102" y="670" text-anchor="end">1m</text>
    <line x1="110" y1="780" x2="130" y2="780" /><text class="scaleText" x="102" y="786" text-anchor="end">0m</text>

    <!-- Inner pond ruler (right) -->
    <line x1="1480" y1="200" x2="1480" y2="780" />
    <line x1="1470" y1="200" x2="1490" y2="200" /><text class="scaleText" x="1498" y="206">5m</text>
    <line x1="1470" y1="316" x2="1490" y2="316" /><text class="scaleText" x="1498" y="322">4m</text>
    <line x1="1470" y1="432" x2="1490" y2="432" /><text class="scaleText" x="1498" y="438">3m</text>
    <line x1="1470" y1="548" x2="1490" y2="548" /><text class="scaleText" x="1498" y="554">2m</text>
    <line x1="1470" y1="664" x2="1490" y2="664" /><text class="scaleText" x="1498" y="670">1m</text>
    <line x1="1470" y1="780" x2="1490" y2="780" /><text class="scaleText" x="1498" y="786">0m</text>
  </g>

  <!-- Layer: Gate (sliding plate). Closed = translateY(0). Open = translateY(-600). -->
  <g id="layer_gate" filter="url(#shadowSoft)">
    <g id="gate_plate_group" transform="translate(0 0)" data-closed-dy="0" data-open-dy="-600">
      <!-- Tall plate so it can slide upward beyond frame. -->
      <rect id="gate_plate" x="760" y="100" width="80" height="680" rx="12" fill="url(#gradSteel)" stroke="#0b1224" stroke-opacity="0.55" stroke-width="10" />
      <!-- Subtle inner ribs -->
      <path d="M775 124 V756" stroke="rgba(15,23,42,0.20)" stroke-width="6" stroke-linecap="round"/>
      <path d="M800 124 V756" stroke="rgba(15,23,42,0.20)" stroke-width="6" stroke-linecap="round"/>
      <path d="M825 124 V756" stroke="rgba(15,23,42,0.20)" stroke-width="6" stroke-linecap="round"/>
    </g>
    <!-- Plate status label (static, not moving) -->
</g>

  <!-- Layer: Labels -->
  <g id="layer_text" font-family="system-ui,-apple-system,'Segoe UI',Roboto,'PingFang SC','Microsoft YaHei',sans-serif" fill="rgba(226,232,240,0.95)">
    <text x="160" y="155" font-size="22" font-weight="900">外塘</text>
    <text x="880" y="155" font-size="22" font-weight="900">内塘</text>
    <text x="800" y="155" text-anchor="middle" font-size="18" font-weight="800" fill="rgba(165,180,207,0.95)">水闸</text>
  </g>
</svg>
